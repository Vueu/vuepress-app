---
title: åšå®¢å…¼å®¹PWA
date: 2022-5-17
author: Aavin
categories:
  - åšå®¢æ­å»º
tags:
  - åšå®¢ä¼˜åŒ–
---
### PWA 

PWAï¼Œè‹±æ–‡å…¨ç§°ï¼šProgressive Web Appsï¼Œ ä¸­æ–‡ç¿»è¯‘ï¼š**æ¸è¿›å¼ Web åº”ç”¨**ã€‚

ğŸ’¯

å¼•ç”¨ MDN çš„ä»‹ç»ï¼š

> PWA æŒ‡çš„æ˜¯ä½¿ç”¨æŒ‡å®šæŠ€æœ¯å’Œæ ‡å‡†æ¨¡å¼æ¥å¼€å‘çš„ Web åº”ç”¨ï¼Œè¿™åŒæ—¶èµ‹äºˆå®ƒä»¬ Web åº”ç”¨å’ŒåŸç”Ÿåº”ç”¨çš„ç‰¹æ€§ã€‚
>
> ä¾‹å¦‚ä¸€æ–¹é¢ï¼ŒWeb åº”ç”¨æ›´åŠ æ˜“äºå‘ç°ï¼šç›¸æ¯”äºå®‰è£…åº”ç”¨ï¼Œè®¿é—®ä¸€ä¸ªç½‘ç«™æ˜¾ç„¶æ›´åŠ å®¹æ˜“å’Œè¿…é€Ÿã€‚ä½ è¿˜å¯ä»¥é€šè¿‡é“¾æ¥æ¥åˆ†äº« Web åº”ç”¨ã€‚
>
> å¦ä¸€æ–¹é¢ï¼ŒåŸç”Ÿåº”ç”¨ä¸æ“ä½œç³»ç»Ÿå¯ä»¥æ›´åŠ å®Œç¾çš„æ•´åˆï¼Œä¹Ÿå› æ­¤ä¸ºç”¨æˆ·æä¾›äº†æ— ç¼çš„ç”¨æˆ·ä½“éªŒã€‚ä½ å¯ä»¥é€šè¿‡å®‰è£…åº”ç”¨ä½¿å¾—å®ƒåœ¨ç¦»çº¿çš„çŠ¶æ€ä¸‹ä¹Ÿå¯ä»¥è¿è¡Œï¼›ç›¸è¾ƒäºä½¿ç”¨æµè§ˆå™¨è®¿é—®ï¼Œç”¨æˆ·ä¹Ÿæ›´å–œæ¬¢é€šè¿‡ç‚¹å‡»ä¸»é¡µä¸Šçš„å›¾æ ‡æ¥è®¿é—®å®ƒä»¬å–œçˆ±çš„åº”ç”¨ã€‚
>
> PWA èµ‹äºˆäº†æˆ‘ä»¬åˆ›å»ºåŒæ—¶æ‹¥æœ‰ä»¥ä¸Šä¸¤ç§ä¼˜åŠ¿çš„åº”ç”¨çš„èƒ½åŠ›ã€‚

### ä½“éªŒ

å¦‚æœä½ ä¹‹å‰æ²¡æœ‰äº†è§£è¿‡ PWAï¼Œå¤§æ¦‚ç‡å¯èƒ½ä¹Ÿä¸æ˜ç™½è¿™æ˜¯ä¸ªä»€ä¹ˆæ•ˆæœï¼Œæˆ‘ä»¬ç›´æ¥çœ‹ä¸€ä¸ª PWA åº”ç”¨ç¤ºä¾‹ï¼Œæˆ‘ä»¬æ‰“å¼€ https://m.weibo.cn/ï¼Œè¿™é‡Œæ˜¯åœ¨ç”µè„‘ç«¯æ‰“å¼€çš„ï¼š

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨åœ°å€æ è¿˜æœ‰ä¸€ä¸ª**å®‰è£…å›¾æ ‡**ï¼Œç‚¹å‡»ä¸€ä¸‹ï¼Œå°±ä¼šå¼¹å‡ºå®‰è£…åº”ç”¨çš„é€‰é¡¹æ¡†ï¼š

![img](./img/1.png)

æˆ‘ä»¬ç‚¹å‡»å®‰è£…åï¼Œè¯¥é¡µé¢ä¼šè‡ªåŠ¨å…³é—­ï¼Œç„¶åå¼€å¯ä¸€ä¸ªåº”ç”¨çª—å£ï¼š

![img](./img/2.png)

åŒæ—¶ï¼Œæ‰“å¼€æ¡Œé¢ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°å·²ç»æ·»åŠ äº†å¾®åšçš„å›¾æ ‡ï¼š

![](img/3.png)

ç‚¹å‡»å°±ä¼šç›´æ¥æ‰“å¼€ä¸Šé¢çš„åº”ç”¨çª—å£ã€‚

ç®€å•çš„æ¥è¯´ï¼Œæˆ‘ä»¬å…¼å®¹ PWAï¼Œå°±æ˜¯æƒ³è¦å®ç°è¿™æ ·çš„æ¡Œé¢å›¾æ ‡çš„åŠŸèƒ½ï¼Œå½“ç„¶äº†ï¼Œ PWA å…¶ä»–è¿˜æœ‰ç¦»çº¿ç¼“å­˜ã€æ¨é€é€šçŸ¥ç­‰åŠŸèƒ½ï¼Œè¿™é‡Œå°±ä¸å¤šè¯´äº†ã€‚

### å¼€å¯ PWA

å¼€å¯ PWAï¼Œéœ€è¦æ³¨æ„ä¸‰ä¸ªç‚¹ï¼š

æä¾›ä¸€ä¸ª manifest.json æ–‡ä»¶ï¼Œæè¿°åº”ç”¨çš„åç§°ã€å›¾æ ‡ç­‰ä¿¡æ¯
å¼€å¯ Service Workerï¼Œè¿™ä¸ªäº¤ç»™ç°æœ‰çš„ PWA æ’ä»¶æ¥å®ç°
å¼€å¯ HTTPS

### å®è·µ

1. å®‰è£…

```bash
yarn add -D @vuepress/plugin-pwa
OR npm install -D @vuepress/plugin-pwa
```

2. ä¿®æ”¹ config.js

```js
module.exports = {
    head: [
        ['link', { rel: 'icon', href: '/logo.png' }],
        ['link', { rel: 'manifest', href: '/manifest.json' }],
        ['meta', { name: 'theme-color', content: '#3eaf7c' }],
        ['meta', { name: 'apple-mobile-web-app-capable', content: 'yes' }],
        ['meta', { name: 'apple-mobile-web-app-status-bar-style', content: 'black' }],
        ['link', { rel: 'apple-touch-icon', href: '/icons/apple-touch-icon-152x152.png' }],
        ['link', { rel: 'mask-icon', href: '/icons/safari-pinned-tab.svg', color: '#3eaf7c' }],
        ['meta', { name: 'msapplication-TileImage', content: '/icons/msapplication-icon-144x144.png' }],
        ['meta', { name: 'msapplication-TileColor', content: '#000000' }]
    ],
    plugins: [
       [
           '@vuepress/pwa',
           {
               serviceWorker: true,
               updatePopup: {
                   message: "å‘ç°æ–°å†…å®¹å¯ç”¨",
                   buttonText: "åˆ·æ–°"
               }
           }
       ]
    ]
}
```

2. æ·»åŠ  manifest.json ç­‰èµ„æº
   æ¥ä¸‹æ¥æˆ‘ä»¬æ·»åŠ æ‰€éœ€è¦çš„èµ„æºï¼Œåœ¨ .vuepressç›®å½•ä¸‹å»ºç«‹ publicæ–‡ä»¶å¤¹ï¼Œç„¶åæ·»åŠ æ‰€éœ€è¦çš„æ–‡ä»¶å¦‚ manifest.jsonæ–‡ä»¶ï¼š

```json
{
    "name": "TypeScriptä¸­æ–‡æ–‡æ¡£",
    "short_name": "TypeScriptDocs",
    "display": "standalone",
    "background_color": "#fff",
    "start_url": "/learn-typescript-test/",
    "scope": "/learn-typescript-test/",
    "description": "TypeScript ä¸­æ–‡æ–‡æ¡£ è¿›é˜¶æ•™ç¨‹",
    "icons": [{
      "src": "logo52.png",
      "sizes": "52x52",
      "type": "image/png"
    },{
       "src": "logo288.png",
       "sizes": "288x288",
       "type": "image/png"
    }]
  }
```

è¿™å…¶ä¸­å­—æ®µçš„å…·ä½“å«ä¹‰ï¼Œå¯ä»¥æŸ¥çœ‹ MDN çš„ Manifest ä»‹ç»ã€‚

**è¦æ³¨æ„å…¶ä¸­çš„ start_urlå’Œscopeï¼Œå¦‚æœä½ ä½¿ç”¨çš„æ˜¯ GitHub æˆ–è€… Gitee ä»“åº“çš„ Pages æœåŠ¡ï¼Œå¹¶ä¸”åœ°å€ä¸Šå¸¦äº†ä»“åº“åï¼Œä½ éœ€è¦å°†è¿™é‡Œçš„learn-typescript-testæ›¿æ¢ä¸ºä½ çš„ä»“åº“åï¼Œå¦‚æœæ˜¯ç›´æ¥çš„åŸŸåï¼Œstart_url å†™æˆ \ï¼Œscopeå†™æˆ . æˆ–è€…ç›´æ¥ä¸å†™ã€‚**

ç„¶åæ˜¯è¡¥é½æ‰€éœ€è¦çš„å›¾æ ‡å›¾ç‰‡ã€‚

4. éƒ¨ç½²ç”Ÿäº§ç¯å¢ƒæµ‹è¯•
   è™½ç„¶æˆ‘ä»¬åœ¨ä¸Šç¯‡ã€ŠVuePress åšå®¢å¦‚ä½•å¼€å¯æœ¬åœ° HTTPS è®¿é—®ã€‹ è®²äº†å¦‚ä½•åœ¨æœ¬åœ°å¼€å¯ HTTPSï¼Œä½†æ˜¯å› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„è¿™ä¸ªæ’ä»¶åªæœ‰åœ¨**ç”Ÿäº§ç¯å¢ƒ**æ‰ä¼šå¼€å¯ Service Workerï¼Œæ‰€ä»¥å‘¢ï¼Œæˆ‘ä»¬è¦**éƒ¨ç½²åˆ°çº¿ä¸Š**çœ‹ä¸€ä¸‹æ•ˆæœï¼Œå¦‚æœé¡ºåˆ©çš„è¯ï¼Œä½ å°±ä¼šçœ‹åˆ°åœ°å€æ ä¸Šä¹Ÿå‡ºç°äº†å®‰è£…å›¾æ ‡ï¼š

   ![](./img/4.png)

### å¸¸è§é—®é¢˜

ä½†å¦‚æœæ²¡æœ‰æ˜¾ç¤ºè¯¥å›¾æ ‡ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹å¼€å‘è€…å·¥å…·é‡Œçš„ã€Œåº”ç”¨ã€ -ã€Œæ¸…å•ã€ï¼Œå…¶ä¸­ä¼šæ˜¾ç¤ºå‡ºç°çš„é”™è¯¯ã€‚

æ ¹æ®è¿™é‡Œçš„æŠ¥é”™è¿›è¡Œæ’æŸ¥ã€‚

ä¸ºæ£€æµ‹åˆ°ä»»ä½•åŒ¹é…çš„ service workerã€‚æ‚¨å¯èƒ½éœ€è¦é‡æ–°åŠ è½½é¡µé¢ï¼Œæˆ–è€…æ£€æŸ¥å½“å‰é¡µé¢çš„ service worker æ˜¯å¦ä¹Ÿæ§åˆ¶äº†æ¸…å•é”™è¯¯ä¸­çš„èµ·å§‹ URLã€‚
è¿™ä¹Ÿæœ‰å¯èƒ½æ˜¯å› ä¸ºä½ çš„ start_url å’Œ scope è®¾ç½®çš„æœ‰é—®é¢˜ã€‚

æ­£å¸¸å®‰è£…åï¼Œå¦‚æœæ‰“å¼€åº”ç”¨å‘ç°èƒŒæ™¯è‰²æ˜¯ Vue ç»¿è‰²ï¼Œæ¯”å¦‚è¿™ç§ï¼š

è¿™æ˜¯å› ä¸ºä½ å¿˜è®°ä¿®æ”¹ config.js é‡Œçš„èƒŒæ™¯è‰²äº†ã€‚
